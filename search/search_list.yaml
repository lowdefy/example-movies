id: results
type: list
properties:
  hideAddButton: true
  hideRemoveButton: true
blocks:
  - id: results.$.skeleton
    type: skeleton
    properties:
      active: true
      avatar:
        size: 200
        shape: square
      paragraph:
        rows: 4
    visible:
      _state: loading
  - id: results.$.item
    type: column
    visible:
      _not:
        _state: loading
    blocks:
      - id: results.$.poster
        type: markdown
        box:
          span: { sm: 8, md: 4 }
        properties:
          content:
            _nunjucks:
              template: |
                {% if poster %}
                  <div style="height: 200px" >
                    <img style="max-width: 100%; max-height: 100%; display:block; margin:auto;" src="{{ poster }}" alt="poster">
                  </div>
                {% else %}
                <div style="height: 200px; font-size: 100px; text-align: center;" >üéû</div>
                {% endif %}
              on:
                _state: results.$
      - id: results.$.content
        type: column
        box:
          span: { sm: 16, md: 20 }
        blocks:
          - id: results.$.description
            type: markdown
            properties:
              content:
                _nunjucks:
                  on:
                    _state: results.$
                  template: |
                    ### {{ title }}
                    <span style="font-size: 14px;">{{ year }}</span> {% for genre in genres %}
                    <span style="font-size: 12px; color: rgba(0,0,0,0.5);">| {{genre}}</span> {% endfor %}

                    {{ plot }}
          - id: results.$.like_anchor
            type: anchor
            box:
              span: { xs: 10, sm: 6, md: 3 }
              align: center
            properties:
              title:
                _state: results.$.likes
              style:
                fontSize: 17px
              icon: heart
              iconTheme:
                _mql_expr:
                  "$cond":
                    - _state: "results.$.liked_by_user"
                    - "filled"
                    - "outlined"
            actions:
              onClick:
                - mutate(): mutation_like_movie
                  call:
                    _not:
                      _state: results.$.liked_by_user
                - mutate(): mutation_unlike_movie
                  call:
                    _state: results.$.liked_by_user
                - set():
                    results.$.liked_by_user:
                      _not:
                        _state: results.$.liked_by_user
                    results.$.likes:
                      _mql_expr:
                        $add:
                          - _state: results.$.likes
                          - $cond:
                              - _state: "results.$.liked_by_user"
                              - -1
                              - 1
          - id: results.$.view_anchor
            type: anchor
            box:
              span: { xs: 12, sm: 8, md: 4 }
            properties:
              title: View Details
              icon: link
            actions:
              onClick:
                - pageLink():
                    pageId: page_details
                    urlQuery:
                      _id:
                        _state: results.$._id
          - id: results.$.rating
            type: markdown
            box:
              span: { xs: 24, sm: 24, md: 16 }
            properties:
              content:
                _nunjucks:
                  on:
                    _state: results.$
                  template: |
                    <span style="font-size: 12px; padding-right: 20px;"><img alt="imdb" height="18px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/IMDB_Logo_2016.svg/250px-IMDB_Logo_2016.svg.png" /> {{ imdb.rating }} / {{imdb.votes//1000}}K  </span> <span style="font-size: 12px; padding-right: 20px;"> <img alt="tm" height="18px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5b/Rotten_Tomatoes.svg/30px-Rotten_Tomatoes.svg.png" /> {{ tomatoes.viewer.rating }} / {{ tomatoes.viewer.numReviews//1000 }}K</span> <span style="font-size: 12px; padding-right: 20px;">üèÜ {{ awards.text }}</span>
